---
import type { Author } from "../types/types";

interface Props {
  authors: Author[];
}

const { authors } = Astro.props;

// Create a mapping of institutions to indices
const institutionMap = new Map();
let institutionIndex = 1;
const authorsWithIndices = authors.map((author) => {
  if (!institutionMap.has(author.institution)) {
    institutionMap.set(author.institution, institutionIndex);
    institutionIndex++;
  }
  return {
    ...author,
    institutionIndex: institutionMap.get(author.institution),
  };
});

// Extract institution names and their indices
const institutions = Array.from(institutionMap.entries());
---
<style>
  /* Set Google Sans font for the entire component */
  .custom-font {
    font-family: 'Google Sans', sans-serif;
  }

  /* Style for author name */
  .author-name {
    color: hsl(204, 86%, 53%) !important;
    font-family: 'Google Sans', sans-serif;
    font-size: 1.2rem;
    font-weight: normal; /* No bold */
  }

  /* Hover effect for author name */
  .author-name:hover {
    text-decoration: underline;
  }

  /* Style for superscript to reduce space */
  .superscript {
    font-size: 0.8rem;
    vertical-align: super;
  }

  /* Styling for institutions displayed in a row */
  .institution-list {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    justify-content: center;
    margin-top: 1.2rem; /* Adds space between the author list and institution list */
  }

  .institution {
    font-family: 'Google Sans', sans-serif;
    font-size: 1.2rem;
  }

  .institution-index {
    font-size: 0.8rem;
    color: #888;
    vertical-align: super;
  }
</style>

<div class="text-center">
  <!-- Render all authors in one line with institution indices as superscript -->
  <div class="flex justify-center flex-wrap gap-x-8 gap-y-4">
    {
      authorsWithIndices.map((author) => (
        <div class="flex flex-col items-center">
          <span class="author-name">
            {author.url ? (
              <a href={author.url} class="author-name">
                {author.name}
              </a>
            ) : (
              author.name
            )}
            {author.institution && (
              <sup class="superscript">{author.institutionIndex}</sup>
            )}
          </span>
        </div>
      ))
    }
  </div>

  <!-- Render institutions in a row with their indices as superscript -->
  <div class="institution-list">
    {
      institutions.map(([institution, index]) => (
        <div class="flex items-center">
          <sup class="institution-index">{index}</sup>
          <span class="institution">{institution}</span>
        </div>
      ))
    }
  </div>
</div>
